---
nginx::package_ensure: '1.10.1-1.el7.ngx'
nginx::config::confd_purge: true
nginx::config::vhost_purge: true
nginx::config::http2: 'on'
# https://mozilla.github.io/server-side-tls/ssl-config-generator/?server=nginx-1.7.12&openssl=1.0.1e&hsts=yes&profile=modern
# enabled TLSv1 to support android < 4.4
nginx::config::ssl_protocols: 'TLSv1 TLSv1.1 TLSv1.2'
nginx::config::ssl_ciphers: <
  ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK
add_header:
  # 180d is required to get an A+ rating from ssllabs.com
  Strict-Transport-Security: "'max-age=15552000'"
  # openssl x509 -in lsst.codes.pem -pubkey -noout | openssl rsa -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64
#  Public-Key-Pins: "'pin-sha256=\"KhocpKDPJ5WatTg6A4CLwPGcxhf+fUGee4FfIk7Nc68=\"; max-age=2592000'"
# alphassl signed *.lsst.codes
ssl_cert: |
  -----BEGIN CERTIFICATE-----
  MIIE1jCCA76gAwIBAgIMG658ld73f3aYlo6ZMA0GCSqGSIb3DQEBCwUAMEwxCzAJ
  BgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWduIG52LXNhMSIwIAYDVQQDExlB
  bHBoYVNTTCBDQSAtIFNIQTI1NiAtIEcyMB4XDTE2MDUyMzIyMzk0N1oXDTE3MDgw
  NzE2MzgwMFowOjEhMB8GA1UECxMYRG9tYWluIENvbnRyb2wgVmFsaWRhdGVkMRUw
  EwYDVQQDDAwqLmxzc3QuY29kZXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK
  AoIBAQC7hT/ozUfwI7We/LP9tB0QDWPZ2N/YXg+qKhEK4B/fp2nouBIkYv8ItH9z
  /+ZIfacevgLLegUGQ/wCoCT0zod53OeSF8jNhom6l4X3HbiAbryRD1eY8MIHCu2g
  3iwulonsvBnbNkB+mzd7f0po0uZkP0r+HKVvIKJligr7B/5yz7CpAk0D7vNSdgFL
  fXk4ADmU/QovXqjz7kbWqnstXuc5ifE8xHrsxSUal/r86EZIHW2zlbYVrP4B5zF7
  Qgyup54XrcjtSzE9AxVriUgU7Fj24fFEoFnw23NQf07gTdaYDe6mW8MceJmOuf/5
  LsbOmsDYMX5V676uqB0jw85hNSOBAgMBAAGjggHIMIIBxDAOBgNVHQ8BAf8EBAMC
  BaAwgYkGCCsGAQUFBwEBBH0wezBCBggrBgEFBQcwAoY2aHR0cDovL3NlY3VyZTIu
  YWxwaGFzc2wuY29tL2NhY2VydC9nc2FscGhhc2hhMmcycjEuY3J0MDUGCCsGAQUF
  BzABhilodHRwOi8vb2NzcDIuZ2xvYmFsc2lnbi5jb20vZ3NhbHBoYXNoYTJnMjBX
  BgNVHSAEUDBOMEIGCisGAQQBoDIBCgowNDAyBggrBgEFBQcCARYmaHR0cHM6Ly93
  d3cuZ2xvYmFsc2lnbi5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQIBMAkGA1UdEwQC
  MAAwPgYDVR0fBDcwNTAzoDGgL4YtaHR0cDovL2NybDIuYWxwaGFzc2wuY29tL2dz
  L2dzYWxwaGFzaGEyZzIuY3JsMCMGA1UdEQQcMBqCDCoubHNzdC5jb2Rlc4IKbHNz
  dC5jb2RlczAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYE
  FCr7qulzZJTradLnMulr9DSEOT9cMB8GA1UdIwQYMBaAFPXN1TwIUPlqTzq3l9pW
  g+Zp0mj3MA0GCSqGSIb3DQEBCwUAA4IBAQBl2XmhCwMzE8yGo5pmvKF6WCIjXBXq
  agH7I4KxgKGtRUTsxbgwv0VUjYUsiTDwEwj7KuIFiW7k4MSGsBu7D+dRXJ0dBzdq
  u2PHwtbeIgNus21fPG3S+BvXWYD1bPqbo4u8vR73/D2MJBe3dRilxKtoJ3eEULDl
  IyCI9y9GWYb5BrRv4kapRzTt7adY7i6xeKtImTdlhSZE0+bhhg2NKOJ7eiVXrJZ0
  5xtHKuYfzrt0owK/zYHP5605nCgvpAAMbDDfkMOIVXsSBJ2JhMaHS7pR0TTb0kOv
  7QN0jg1o89L9mFRJ0dpwZXACaKroKgmdr+Nt4IV6OnaOKae9ILOIQHcU
  -----END CERTIFICATE-----
# alphassl intermediary
ssl_chain_cert: |
  -----BEGIN CERTIFICATE-----
  MIIETTCCAzWgAwIBAgILBAAAAAABRE7wNjEwDQYJKoZIhvcNAQELBQAwVzELMAkG
  A1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsTB1Jv
  b3QgQ0ExGzAZBgNVBAMTEkdsb2JhbFNpZ24gUm9vdCBDQTAeFw0xNDAyMjAxMDAw
  MDBaFw0yNDAyMjAxMDAwMDBaMEwxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9i
  YWxTaWduIG52LXNhMSIwIAYDVQQDExlBbHBoYVNTTCBDQSAtIFNIQTI1NiAtIEcy
  MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2gHs5OxzYPt+j2q3xhfj
  kmQy1KwA2aIPue3ua4qGypJn2XTXXUcCPI9A1p5tFM3D2ik5pw8FCmiiZhoexLKL
  dljlq10dj0CzOYvvHoN9ItDjqQAu7FPPYhmFRChMwCfLew7sEGQAEKQFzKByvkFs
  MVtI5LHsuSPrVU3QfWJKpbSlpFmFxSWRpv6mCZ8GEG2PgQxkQF5zAJrgLmWYVBAA
  cJjI4e00X9icxw3A1iNZRfz+VXqG7pRgIvGu0eZVRvaZxRsIdF+ssGSEj4k4HKGn
  kCFPAm694GFn1PhChw8K98kEbSqpL+9Cpd/do1PbmB6B+Zpye1reTz5/olig4het
  ZwIDAQABo4IBIzCCAR8wDgYDVR0PAQH/BAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8C
  AQAwHQYDVR0OBBYEFPXN1TwIUPlqTzq3l9pWg+Zp0mj3MEUGA1UdIAQ+MDwwOgYE
  VR0gADAyMDAGCCsGAQUFBwIBFiRodHRwczovL3d3dy5hbHBoYXNzbC5jb20vcmVw
  b3NpdG9yeS8wMwYDVR0fBCwwKjAooCagJIYiaHR0cDovL2NybC5nbG9iYWxzaWdu
  Lm5ldC9yb290LmNybDA9BggrBgEFBQcBAQQxMC8wLQYIKwYBBQUHMAGGIWh0dHA6
  Ly9vY3NwLmdsb2JhbHNpZ24uY29tL3Jvb3RyMTAfBgNVHSMEGDAWgBRge2YaRQ2X
  yolQL30EzTSo//z9SzANBgkqhkiG9w0BAQsFAAOCAQEAYEBoFkfnFo3bXKFWKsv0
  XJuwHqJL9csCP/gLofKnQtS3TOvjZoDzJUN4LhsXVgdSGMvRqOzm+3M+pGKMgLTS
  xRJzo9P6Aji+Yz2EuJnB8br3n8NA0VgYU8Fi3a8YQn80TsVD1XGwMADH45CuP1eG
  l87qDBKOInDjZqdUfy4oy9RU0LMeYmcI+Sfhy+NmuCQbiWqJRGXy2UzSWByMTsCV
  odTvZy84IOgu/5ZR8LrYPZJwR2UcnnNytGAMXOLRc3bgr07i5TelRS+KIz6HxzDm
  MTh89N1SyvNTBCVXVmaU6Avu5gMUTu79bZRknl7OedSyps9AsUSoPocZXun4IRZZUw==
  -----END CERTIFICATE-----
# globalsign root
ssl_root_cert: |
  -----BEGIN CERTIFICATE-----
  MIIDdTCCAl2gAwIBAgILBAAAAAABFUtaw5QwDQYJKoZIhvcNAQEFBQAwVzELMAkG
  A1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsTB1Jv
  b3QgQ0ExGzAZBgNVBAMTEkdsb2JhbFNpZ24gUm9vdCBDQTAeFw05ODA5MDExMjAw
  MDBaFw0yODAxMjgxMjAwMDBaMFcxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9i
  YWxTaWduIG52LXNhMRAwDgYDVQQLEwdSb290IENBMRswGQYDVQQDExJHbG9iYWxT
  aWduIFJvb3QgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDaDuaZ
  jc6j40+Kfvvxi4Mla+pIH/EqsLmVEQS98GPR4mdmzxzdzxtIK+6NiY6arymAZavp
  xy0Sy6scTHAHoT0KMM0VjU/43dSMUBUc71DuxC73/OlS8pF94G3VNTCOXkNz8kHp
  1Wrjsok6Vjk4bwY8iGlbKk3Fp1S4bInMm/k8yuX9ifUSPJJ4ltbcdG6TRGHRjcdG
  snUOhugZitVtbNV4FpWi6cgKOOvyJBNPc1STE4U6G7weNLWLBYy5d4ux2x8gkasJ
  U26Qzns3dLlwR5EiUWMWea6xrkEmCMgZK9FGqkjWZCrXgzT/LCrBbBlDSgeF59N8
  9iFo7+ryUp9/k5DPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8E
  BTADAQH/MB0GA1UdDgQWBBRge2YaRQ2XyolQL30EzTSo//z9SzANBgkqhkiG9w0B
  AQUFAAOCAQEA1nPnfE920I2/7LqivjTFKDK1fPxsnCwrvQmeU79rXqoRSLblCKOz
  yj1hTdNGCbM+w6DjY1Ub8rrvrTnhQ7k4o+YviiY776BQVvnGCv04zcQLcFGUl5gE
  38NflNUVyRRBnMRddWQVDf9VMOyGj/8N7yy5Y0b2qvzfvGn9LhJIZJrglfCm7ymP
  AbEVtQwdpf5pLGkkeB6zpxxxYu7KyJesF12KwvhHhm4qxFYxldBniYUr+WymXUad
  DKqC5JlR3XC321Y9YeRq4VzW9v493kHMB65jUr9TU/Qr6cf9tveCX4XSQRjbgbME
  HMUfpIBvFSDJ3gyICh3WZlXi/EjJKSZp4A==
  -----END CERTIFICATE-----
ssl_key: |
  ENC[PKCS7,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]
# conf shared between the jenkins master and slave roles
jenkins::slave::version: '2.2'
jenkins::slave::source: "https://repo.jenkins-ci.org/releases/org/jenkins-ci/plugins/swarm-client/2.2/"
jenkins::slave::ui_user: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAqBl1AXBWm56h6ITRCo33YlYF0HGJLjdIfcIPRCatHjRqYgrWacud6jIrZ2ycm7ic9V3PH3CrpY+kMh2dv3xzOuPdleG4MxiMhb4DCCUVvC6IQEnwoXnIeGKciG2+122qJCPoTkRltBCwIMdHp5nSntoCyEoWRremnmvMq7gtngFDJELENt2VHtMLTW36SWsKXEZaZwVrRgnEjpj0vHBVrQylUVnPDQve2v2PT7IqjWXMDoJoZ1N4vyJMdaXgNMfnEx8kPfu0+R6+7Rn3t0kwDzJ6p4kLrKq8p1+YifpmreWy82jmUQfs6yLpxdBNuQKn5p/Amd6WsR4VtX+2ifwKMjA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBCnAHXFH4jmeL3ykeY/4ddCgBDHjQ3GOz9h9Wa+dXqmePFX]
jenkins::slave::ui_pass: ENC[PKCS7,MIIBmQYJKoZIhvcNAQcDoIIBijCCAYYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAhw6A1klnwgzT1dmr+VNd6RYifZKgUcU35GHrq9D2zVrNSUkOY9mKb+KiLK21QxgKxfmw1Nt+7y7ronFbaQfO7IwNW9sScGONfGshm4Qgg+b5mX6g5wL328W4e7H+IieNbAnVJKTqFP+sW5KtafsBgE/HpIUgS2vvla4Xq3kQrXwRnx3bHoXo/yYwWc5owLsHJgAvUZG6PY+TWFYaV/JN37iWidtHJlFy4Dg2T48BN2itCduQ50DVjlct4Pha9jDtMfBBhOJzG5cDCtE1vQ0BERhpkeEqXLYUmW61wfDmgaJm7n4f5pZQNnDoqKWMtCvGpy7TFlVTyKx9Wa7N/f3ruzBcBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBD/EijukXsOPqiRAovvuyV0gDDImBkGR1GRyl85vA7cfUteFYYYq01t6JcK8EJcQBHc6mwYYVAYYmYc25E225U3CVg=]
# pipeline scripts will try to restart on a slave based its name; if a slave
# witha unique id in its name is restarted, it reattaches with a new unique
# name and the pipeline script hangs forever.
jenkins::slave::disable_clients_unique_id: true
jenkins::slave::delete_existing_clients: true
